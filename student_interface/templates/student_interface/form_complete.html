{% extends '_base.html' %}

{% block title %}Form Complete - {{ form.title }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto py-12">
    <div class="text-center mb-8">
        <div class="mb-6">
            <i class="fas fa-check-circle text-green-500 text-6xl"></i>
        </div>

        <h1 class="mb-4">Form Complete!</h1>

        <p class="text-lg text-gray-700 mb-8">
            Thank you for completing <strong>{{ form.title }}</strong>.
        </p>
    </div>

    {% if show_scores and scores %}
    <div class="mb-8">
        <h2 class="mb-6">Your Results</h2>

        {% for category, category_data in scores.items %}
        <div class="mb-6 p-6 bg-white border border-gray-200 rounded-lg shadow-sm">
            <div class="mb-4">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="text-xl font-semibold text-gray-900">{{ category }}</h3>
                    <span class="text-lg font-semibold text-gray-700">
                        {{ category_data.score }} / {{ category_data.max_score }}
                    </span>
                </div>

                <!-- Progress bar for category -->
                <div class="w-full bg-gray-200 rounded-full h-3">
                    {% widthratio category_data.score category_data.max_score 100 as percentage %}
                    <div class="bg-blue-600 h-3 rounded-full" style="width: {{ percentage }}%"></div>
                </div>
            </div>

            <!-- Subcategories -->
            {% if category_data.sub_categories %}
            <div class="mt-4 space-y-3 pl-4 border-l-2 border-gray-200">
                {% for subcategory, subcategory_data in category_data.sub_categories.items %}
                <div>
                    <div class="flex justify-between items-center mb-1">
                        <span class="text-sm font-medium text-gray-700">{{ subcategory }}</span>
                        <span class="text-sm text-gray-600">
                            {{ subcategory_data.score }} / {{ subcategory_data.max_score }}
                        </span>
                    </div>

                    <!-- Progress bar for subcategory -->
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        {% widthratio subcategory_data.score subcategory_data.max_score 100 as sub_percentage %}
                        <div class="bg-green-500 h-2 rounded-full" style="width: {{ sub_percentage }}%"></div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="text-center space-y-4">
        <a href="{% url 'student_interface:form_detail' form.slug %}" class="btn btn-primary">
            View Form
        </a>
    </div>
</div>
{% endblock %}
