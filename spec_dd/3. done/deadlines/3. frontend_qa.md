# Deadline Feature — Frontend QA Checklist

## Prerequisites

1. Start the dev server: `uv run python manage.py runserver`
2. Log in to the Django admin at `/admin/` as a superuser
3. Ensure you have:
   - At least one Course with topics, forms, and a CoursePart
   - A Student linked to a test user
   - A Cohort with that student as a member
   - A CohortCourseRegistration linking the cohort to the course
   - Optionally: a StudentCourseRegistration for the same student and course (for testing duplicate registration scenarios)

---

## Test 1: Admin — Create Deadlines

### 1a: CohortDeadline via inline
1. Go to `/admin/freedom_ls_student_management/cohortcourseregistration/`
2. Click on an existing CohortCourseRegistration
3. Verify there are inline sections for "Cohort Deadlines" and "Student Cohort Deadline Overrides"
4. Add a CohortDeadline:
   - Leave content_type and object_id blank (course-level deadline)
   - Set a deadline datetime in the future
   - Set `is_hard_deadline = True`
   - Save
5. **Expected:** Deadline appears in the inline list

### 1b: CohortDeadline standalone
1. Go to `/admin/freedom_ls_student_management/cohortdeadline/`
2. Verify the list displays: cohort name, course name, content item, deadline, is_hard_deadline
3. Verify you can filter by cohort, course, and is_hard_deadline

### 1c: StudentDeadline via inline
1. Go to `/admin/freedom_ls_student_management/studentcourseregistration/`
2. Click on an existing StudentCourseRegistration
3. Verify there is an inline section for "Student Deadlines"
4. Add a deadline and save

### 1d: StudentCohortDeadlineOverride
1. Go back to a CohortCourseRegistration
2. Add a StudentCohortDeadlineOverride for a specific student
3. **Expected:** Saves successfully, appears in inline list

---

## Test 2: TOC — Deadline Display

### 2a: Hard deadline (future)
1. Log in as the test student user
2. Navigate to the course page: `/courses/<course-slug>/`
3. **Expected:** The TOC shows the hard deadline in **red** next to the relevant items (or all items if course-level)

### 2b: Soft deadline (future)
1. In admin, change the deadline's `is_hard_deadline` to `False`
2. Reload the course page as the student
3. **Expected:** The deadline appears in **orange** instead of red

### 2c: Multiple deadlines
1. Ensure the student has both a CohortDeadline and a StudentDeadline for the same course
2. Reload the course page
3. **Expected:** Both deadlines are displayed on the TOC

### 2d: CoursePart deadline
1. In admin, create a CohortDeadline pointing to a CoursePart (set content_type to CoursePart, object_id to the CoursePart's UUID)
2. Reload the course page
3. **Expected:** The deadline shows on the CoursePart row, not on individual items within it

---

## Test 3: Access Control — Hard Deadline Expired

### 3a: Item-level hard deadline expired, item NOT completed
1. In admin, set an item-level hard deadline to a past datetime
2. Reload the course page as the student (who has NOT completed that item)
3. **Expected:** The item appears locked/greyed out and is NOT clickable

### 3b: Item-level hard deadline expired, item completed
1. Complete the item first (navigate to it and mark complete)
2. Set the deadline to the past
3. Reload the course page
4. **Expected:** The item is still accessible (clickable with a check icon)

### 3c: Course-level hard deadline expired
1. Set a course-level hard deadline to the past
2. Reload the course page
3. **Expected:** All incomplete items are locked, completed items remain accessible

### 3d: Soft deadline expired
1. Set a soft deadline to the past
2. Reload the course page
3. **Expected:** No items are locked. The deadline is shown (possibly muted) but all items remain accessible

### 3e: Direct URL access to locked item
1. With an expired hard deadline on an incomplete item, try navigating directly to the item's URL
2. **Expected:** Redirected back to the course TOC (or shown a message indicating the item is locked)

---

## Test 4: Override Priority

### 4a: Override beats cohort deadline
1. Set a CohortDeadline for an item to yesterday (past)
2. Set a StudentCohortDeadlineOverride for the same student + item to tomorrow (future)
3. Reload the course page as the student
4. **Expected:** The item is NOT locked (the override's future deadline governs)

### 4b: Item-level beats course-level
1. Set a course-level deadline to yesterday
2. Set an item-level deadline for a specific topic to tomorrow
3. Reload the course page
4. **Expected:** That specific topic is NOT locked (item-level takes precedence), but other incomplete items ARE locked by the course-level deadline
