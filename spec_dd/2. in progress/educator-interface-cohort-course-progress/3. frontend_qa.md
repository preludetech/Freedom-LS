# Frontend QA: Cohort Course Progress Panel

## Prerequisites

- Dev server running: `uv run python manage.py runserver`
- A user account with educator permissions (can view cohorts)
- At least one cohort with:
  - Students (via CohortMembership)
  - Course registrations (CohortCourseRegistration) — at least one active, ideally one inactive too
  - Courses with Topics and Forms (including at least one quiz-type form)
  - Some student progress data (TopicProgress, FormProgress records)
  - Some CohortDeadline records (both hard and soft, including at least one course-level deadline)
  - At least one StudentCohortDeadlineOverride

## Login

1. Navigate to `http://localhost:8000/accounts/login/`
2. Log in with the educator user credentials

---

## Test 1: Panel Appears on Cohort Detail Page

1. Navigate to `http://localhost:8000/educator-interface/cohorts/`
2. Click on a cohort name to go to its detail page
3. **Verify:** A "Course Progress" panel appears below the existing panels (Details, Course Registrations, Students)
4. **Verify:** The panel has a course selection dropdown at the top

---

## Test 2: Course Selection Dropdown

1. On the cohort detail page, look at the Course Progress panel
2. **Verify:** The dropdown lists all course registrations for this cohort
3. **Verify:** Active registrations show their course title normally
4. **Verify:** Inactive registrations show "(inactive)" next to the course title
5. **Verify:** The first active registration is selected by default
6. Select a different course from the dropdown
7. **Verify:** The grid reloads without a full page refresh (HTMX partial reload)
8. **Verify:** The grid now shows data for the newly selected course

---

## Test 3: Empty States

### No course registrations
1. Navigate to a cohort that has no course registrations
2. **Verify:** The Course Progress panel shows a message like "No course registrations for this cohort"

### No students
1. Navigate to a cohort that has course registrations but no students
2. **Verify:** The grid area shows a message indicating no students in the cohort

### No progress data
1. Navigate to a cohort where students have not started any course items
2. **Verify:** All cells show dash/empty state
3. **Verify:** All students show 0% progress and appear in any order (all tied)

---

## Test 4: Progress Grid Layout

1. Navigate to a cohort with students and course progress
2. **Verify:** The grid has:
   - A frozen first column with student names
   - A frozen header row with item names
   - Scrollable body area (if content overflows)
3. Scroll horizontally — **Verify:** Student names column stays fixed
4. Scroll vertically — **Verify:** Header row stays fixed

---

## Test 5: Course Part Headers

1. Select a course that has CourseParts
2. **Verify:** There are two header rows:
   - Row 1: Course part names spanning across their child items
   - Row 2: Individual item names
3. **Verify:** Column spans are correct (each part header spans exactly its children)

### Flat course (no CourseParts)
1. Select a course with no CourseParts (all items are direct children)
2. **Verify:** There is only one header row with item names

---

## Test 6: Student Sorting

1. On a cohort with varied student progress
2. **Verify:** Students are sorted by course progress ascending (least progress first)
3. **Verify:** Students with 0% or no progress appear at the top
4. **Verify:** Students with higher completion appear lower in the list

---

## Test 7: Topic Cell Content

1. Find a student who has:
   - A completed topic: **Verify** cell shows a checkmark icon + completion date/time
   - A started but incomplete topic: **Verify** cell shows a play icon + start date/time
   - A not-started topic: **Verify** cell shows a dash or is empty

---

## Test 8: Quiz Form Cell Content

1. Find a student who has completed a quiz form
2. **Verify:** Cell shows:
   - Score as percentage (e.g. "75%")
   - Pass/fail indicator (if the form has `quiz_pass_percentage` set)
   - Attempt count (e.g. "(x3)")
3. Find a student who started but hasn't completed a quiz
4. **Verify:** Cell shows play icon + start date/time

---

## Test 9: Non-Quiz Form Cell Content

1. Find a student who has completed a non-quiz form (CATEGORY_VALUE_SUM or no scoring)
2. **Verify:** Cell shows checkmark + completion date/time (same pattern as topics)
3. **Verify:** No score is displayed

---

## Test 10: Column Pagination

1. Select a course with more than 15 items
2. **Verify:** Only ~15 columns are shown at a time
3. **Verify:** Prev/Next navigation controls are visible
4. Click "Next" — **Verify:** The next page of columns loads
5. **Verify:** Course part headers still display correctly across page boundaries
6. **Verify:** Student rows remain the same (column pagination is independent of row pagination)

---

## Test 11: Student (Row) Pagination

1. Navigate to a cohort with more than 20 students
2. **Verify:** Pagination controls appear below the grid
3. Click to page 2 — **Verify:** Different students are shown
4. **Verify:** Column page is preserved when changing student page

---

## Test 12: Cohort Deadlines in Headers

1. Set up CohortDeadline records for the selected registration
2. **Verify:** Deadlines appear in the header area for the relevant column
3. **Verify:** Hard deadlines are styled distinctly (bold, stronger colour) from soft deadlines
4. If a course-level deadline exists (null content item): **Verify** it appears above or beside the grid

---

## Test 13: Student Deadline Overrides

1. Set up a StudentCohortDeadlineOverride for a student/item that differs from the cohort deadline
2. **Verify:** The cell for that student/item shows the override deadline
3. **Verify:** It is visually distinguished from the default cohort deadline (different colour/icon)

---

## Test 14: Overdue Highlighting

1. Set up a deadline that has already passed for an item a student has NOT completed
2. **Verify:** The cell is visually flagged as overdue (red border/background, warning icon)
3. Compare soft vs hard deadline overdue items:
   - **Verify:** Hard deadline overdue items have more prominent styling than soft deadline overdue items

---

## Test 15: Student Name Links

1. Click on a student's name in the first column
2. **Verify:** It navigates to the student detail page in the educator interface
3. For a student with no first/last name set: **Verify** their email address is shown instead
